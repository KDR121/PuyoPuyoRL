# 「ぷよぷよ」のゲームAI

## 作品説明

SEGA社が制作・コンパイルを行っている「ぷよぷよ」シリーズに対して、自動でゲームを解くAIを深層強化学習によって作成した。

## 制作目的

老若男女問わず瞬時にゲームの内容やルールが理解できるゲームでありながらも、eSportsとして競技性・戦略性があり、知れば知るほど奥深さを感じるゲームである「ぷよぷよ」に対して、私自身がこれまで勉強してきた機械学習や深層学習の知識を活かしてAIを作成したいと考えたため。


## 制作概要

「ぷよぷよ通」の一人用モードできる限り高いスコアを獲得することに対してアプローチを行った。

## 使用手法
### 強化学習
![rl](https://user-images.githubusercontent.com/59335458/152766417-1a71d0ea-6ae0-4e6d-b60b-481d2846d386.PNG)
機械学習の一種であり、コンピューターエージェントが動的環境と、繰り返し試行錯誤のやり取りを重ねることによってタスクを実行できるようになる手法。  
この学習手法は、エージェントはタスクの報酬を最大化する一連の意思決定を行ういことができる。  
また、人間が介入したり、タスクを達成するために明示的にプログラムする必要がない学習手法である。  
強化学習で学習されたAIは囲碁やチェス、将棋などのボードゲームやビデオゲームにおいて、人間とのプレイヤーとの勝負で勝利を収めている。


## 開発環境
python 3.7
Reinforcement Learning  
enviroment : [frostburn](https://github.com/frostburn/gym_puyopuyo)  
Agent : Deep Q-Network  
pytorch:  
OpenAI gym:  

## 結果・考察
#### 学習初期  
一定の箇所にのみ積み上がり、連鎖はおろか必要最低数でゲームオーバーになってしまう。  
<img src = "https://user-images.githubusercontent.com/59335458/153154451-43e63540-701a-4abe-9418-08b5002b47d2.gif" width = 200px>

#### 学習中期  
一連鎖や二連鎖は確認できるが三連鎖以上の連鎖は確認されず、まだ埋められるマス目があってもゲームオーバーになってしまう。  
<img src = "https://user-images.githubusercontent.com/59335458/152766892-1fec58dc-07d8-4fb1-8814-e58b906422f2.PNG" width = 200px>

#### 学習終盤  
一連鎖や二連鎖を行わず、高く積み上げてから下の方のぷよを消すことで雪崩的に大連鎖を狙っている様子が確認できる。最終的にはゲームオーバーになる前に全てのマス目を埋めている。  
<img src = "https://user-images.githubusercontent.com/59335458/153155589-ecabbbe1-f373-4038-bf7b-775fd0849557.gif" width = 200px>

## 追加実装
当初の目的である高いスコアを獲得するのに加えて、  
１．少ないぷよ数を維持するAI（全消しを狙うAI）　   
２．2,3連鎖を狙い続けるAI  
３．大連鎖を狙い続けるAI  
を作成した。

### 追加実装結果
１．少ないぷよ数を維持するAI（全消しを狙うAI）   
<img src = "https://user-images.githubusercontent.com/59335458/154214414-fb0914d0-1d36-4d52-87e4-ce61780c5ab9.gif" width = 200px>  
常に消せるぷよがあれば消している動作が確認でき、全消しもしている。  

２．2,3連鎖を狙い続けるAI  
<img src = "https://user-images.githubusercontent.com/59335458/154214402-5b7e62fd-3f55-4970-8c57-74c1c07851a3.gif" width = 200px>  
2~3連鎖をコンスタントに打つことができていることが確認できる。

３．大連鎖を狙い続けるAI  
<img src = "https://user-images.githubusercontent.com/59335458/153344564-dc68598e-82ae-41b3-80a8-0f50de2379ed.gif" width = 200px>  
4連鎖以上を打つことは確認できたが、偶然である可能性も高い。これは強化学習の報酬設計に問題があり、大連鎖を打つという条件が整いにくくうまく学習できていないことが原因としてあげられる。大連鎖のようなランダムに動かしても起こりにくい現象はさらなる細かい調整及び大幅な改良が必要である。  




